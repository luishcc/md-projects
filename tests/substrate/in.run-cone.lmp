units lj
dimension 3
boundary p p f

processors 2 2 *

atom_style hybrid angle mdpd
neighbor 0.3 bin
neigh_modify every 1 delay 0 check yes
comm_modify vel yes cutoff 2.0

region        box  block -20 20 -20 20 0 30 units box
create_box    2    box

mass * 1

variable R equal 4
region        wall  cone z 0 0 15 0 0 15 side out
# region        wall_out   block -3 5 INF INF INF INF side out


region        drop   sphere -13.2 0 8 v_R

create_atoms  1 random $(round(6.9*3.1415*v_R^3*4/3)) 2021 drop
# create_atoms  2 random $(round(10.9*3.1415*v_R^3*4/3)) 2021 wall 

group drop type 1

###########################################################
# Pair, Bond and Angle Coefficients

pair_style hybrid/overlay mdpd/rhosum mdpd 1.0 1.0 65689
pair_coeff  *  *   mdpd/rhosum  0.75

pair_coeff  1  1   mdpd  -50.0  25.0  4.5  1.0  0.75
pair_coeff  1  2   mdpd  0.0  0.0  0  1.0  0.75
pair_coeff  2  2   mdpd  0.0  0.0  0  1.0  0.75



###########################################################

compute             mythermo all temp
thermo              100
thermo_modify       temp mythermo
thermo_modify       flush yes

dump 1 all atom 100 wall-cone.lammpstrj
velocity all create 1 123 dist gaussian
velocity all zero linear

min_style cg
minimize 1e-4 1e-4 1000 10000



fix         mvv     all mvv/dpd 0.65

fix wall all wall/region wall lj93 3 1 2 
# fix wall all wall/region wall harmonic 0.5 1 2


# fix wallhi all wall/lj93 zlo 3 2.0 0.5 1.0 units box

timestep 0.01
run 5000000

velocity all set 0.1 NULL NULL sum yes

run 100000



